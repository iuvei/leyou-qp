{"version":3,"sources":["..\\..\\..\\..\\..\\assets\\scripts\\components/assets\\scripts\\components\\AppStart.js"],"names":["cc","Class","extends","Component","properties","lblLoadingMsg","Label","_index","_scheduleId","onLoad","th","initEventHandlers","log","webSocketManager","dataEventHandler","node","start","connectGameServer","ip","port","namespace","unschedule","wc","show","params","operation","data","code","args","ws","send","JSON","stringify","schedule","x","dian","padStart","string","onDestroy","update","dt"],"mappings":";;;;;;AAAAA,GAAGC,KAAH,CAAS;AACLC,aAASF,GAAGG,SADP;;AAGLC,gBAAY;AACRC,uBAAeL,GAAGM,KADV;AAERC,gBAAQ,IAFA;AAGRC,qBAAa;AAHL,KAHP;;AASLC,YAAQ,kBAAW;AACf,aAAKF,MAAL,GAAc,CAAd;AACA,YAAIG,MAAM,IAAV,EAAgB;AACZ;AACH;AACD,aAAKC,iBAAL;AACH,KAfI;AAgBLA,qBAhBK,+BAgBe;AAChBX,WAAGY,GAAH,CAAO,8BAAP;AACAF,WAAGG,gBAAH,CAAoBC,gBAApB,GAAuC,KAAKC,IAA5C;AACA;;;;;;AAMH,KAzBI;;AA0BLC,WAAO,iBAAW;AAAA;;AACdN,WAAGG,gBAAH,CAAoBI,iBAApB,CACI;AACIC,gBAAI,eADR;AAEIC,kBAAM,KAFV;AAGIC,uBAAW;AAHf,SADJ,EAMI,YAAM;AACF,kBAAKC,UAAL,CAAgB,MAAKb,WAArB;AACAE,eAAGY,EAAH,CAAMC,IAAN,CAAW,cAAX;AACA,gBAAIC,SAAS;AACTC,2BAAW,UADF;AAETC,sBAAM,EAAEC,MAAMjB,GAAGkB,IAAH,CAAQD,IAAhB;AAFG,aAAb;AAIA3B,eAAGY,GAAH,CAAO,oCAAP,EAA6CY,MAA7C;AACAd,eAAGmB,EAAH,CAAMC,IAAN,CAAWC,KAAKC,SAAL,CAAeR,MAAf,CAAX;AACH,SAfL;;AAkBA,aAAKhB,WAAL,GAAmB,KAAKyB,QAAL,CAAc,YAAM;AACnC,gBAAIC,IAAI,MAAK3B,MAAL,GAAc,CAAtB;AACA,gBAAI4B,OAAO,GAAGC,QAAH,CAAYF,IAAI,CAAhB,EAAmB,GAAnB,CAAX;AACA,cAAE,MAAK3B,MAAP;AACA,kBAAKF,aAAL,CAAmBgC,MAAnB,kDAAsCF,IAAtC;AACH,SALkB,EAKhB,IALgB,CAAnB;AAMH,KAnDI;AAoDLG,eAAW,qBAAW;AAClBtC,WAAGY,GAAH,CAAO,oBAAP;AACA,aAAKS,UAAL,CAAgB,KAAKb,WAArB;AACH,KAvDI;AAwDL+B,YAAQ,gBAASC,EAAT,EAAa,CAAE;AAxDlB,CAAT","file":"AppStart.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\scripts\\components","sourcesContent":["cc.Class({\n    extends: cc.Component,\n\n    properties: {\n        lblLoadingMsg: cc.Label,\n        _index: null,\n        _scheduleId: null\n    },\n\n    onLoad: function() {\n        this._index = 0;\n        if (th == null) {\n            return;\n        }\n        this.initEventHandlers();\n    },\n    initEventHandlers() {\n        cc.log(\"AppStart initEventHandlers()\");\n        th.webSocketManager.dataEventHandler = this.node;\n        /*\n        this.node.on(\"api_connect_success\", () => {\n            cc.log(\"<<<===AppStart api_connect_success\");\n            this.unschedule(this._scheduleId);\n        });\n        */\n    },\n    start: function() {\n        th.webSocketManager.connectGameServer(\n            {\n                ip: \"47.96.177.207\",\n                port: 10000,\n                namespace: \"api\"\n            },\n            () => {\n                this.unschedule(this._scheduleId);\n                th.wc.show(\"正在获取TOKEN...\");\n                let params = {\n                    operation: \"getToken\",\n                    data: { code: th.args.code }\n                };\n                cc.log(\"===>>>[getToken] WebSocketManager:\", params);\n                th.ws.send(JSON.stringify(params));\n            }\n        );\n\n        this._scheduleId = this.schedule(() => {\n            let x = this._index % 6;\n            let dian = \"\".padStart(x + 1, \".\");\n            ++this._index;\n            this.lblLoadingMsg.string = `正在连接服务器${dian}`;\n        }, 0.25);\n    },\n    onDestroy: function() {\n        cc.log(\"Appstart onDestroy\");\n        this.unschedule(this._scheduleId);\n    },\n    update: function(dt) {}\n});\n"]}