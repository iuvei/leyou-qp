{"version":3,"sources":["..\\..\\..\\..\\assets\\scripts/assets\\scripts\\WebSocketManager.js"],"names":["cc","Class","extends","Component","properties","dispatchEvent","event","data","dataEventHandler","emit","initHandlers","log","th","ws","addHandler","JSON","stringify","connectServer","ip","port","connected","addr","connect","director","loadScene"],"mappings":";;;;;;AAAAA,GAAGC,KAAH,CAAS;AACLC,aAASF,GAAGG,SADP;;AAGLC,gBAAY,EAHP;;AAKLC,iBALK,yBAKSC,KALT,EAKgBC,IALhB,EAKsB;AACvB,YAAI,KAAKC,gBAAT,EAA2B;AACvB,iBAAKA,gBAAL,CAAsBC,IAAtB,CAA2BH,KAA3B,EAAkCC,IAAlC;AACH;AACJ,KATI;;AAULG,kBAAc,wBAAW;AAAA;;AACrBV,WAAGW,GAAH,CAAO,kCAAP;AACA;AACAC,WAAGC,EAAH,CAAMC,UAAN,CAAiB,aAAjB,EAAgC,gBAAQ;AACpCd,eAAGW,GAAH,CAAO,kCAAP,EAA2CI,KAAKC,SAAL,CAAeT,IAAf,CAA3C;AACA,kBAAKF,aAAL,CAAmB,aAAnB,EAAkCE,IAAlC;AACH,SAHD;;AAKA;AACAK,WAAGC,EAAH,CAAMC,UAAN,CAAiB,YAAjB,EAA+B,gBAAQ;AACnCd,eAAGW,GAAH,CAAO,0BAAP;AACH,SAFD;AAGH,KAtBI;;AAwBLM,mBAAe,6BAAuB;AAAA;;AAAA,YAAZC,EAAY,QAAZA,EAAY;AAAA,YAARC,IAAQ,QAARA,IAAQ;;AAClCnB,WAAGW,GAAH,CAAOC,GAAGC,EAAH,CAAMO,SAAb;AACAR,WAAGC,EAAH,CAAMK,EAAN,GAAWA,EAAX;AACAN,WAAGC,EAAH,CAAMM,IAAN,GAAaA,IAAb;AACAP,WAAGC,EAAH,CAAMQ,IAAN,aAAqBH,EAArB,SAA2BC,IAA3B;AACAP,WAAGC,EAAH,CAAMS,OAAN,CACI,YAAM;AACF,mBAAKjB,aAAL,CAAmB,iBAAnB;AACAL,eAAGW,GAAH,CAAO,0BAAP;AACA;AACAX,eAAGuB,QAAH,CAAYC,SAAZ,CAAsB,MAAtB,EAA8B,YAAM;AAChC,uBAAKnB,aAAL,CAAmB,iBAAnB;AACH,aAFD;AAGH,SARL,EASI,YAAM;AACFL,eAAGW,GAAH,CAAO,0BAAP;AACH,SAXL;AAaH;AA1CI,CAAT","file":"WebSocketManager.js","sourceRoot":"..\\..\\..\\..\\assets\\scripts","sourcesContent":["cc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {},\r\n\r\n    dispatchEvent(event, data) {\r\n        if (this.dataEventHandler) {\r\n            this.dataEventHandler.emit(event, data);\r\n        }\r\n    },\r\n    initHandlers: function() {\r\n        cc.log(\"==>WebSocketManager initHandlers\");\r\n        //连接成功初始化信息\r\n        th.ws.addHandler(\"getUserInfo\", data => {\r\n            cc.log(\"==>WebSocketManager getUserInfo:\", JSON.stringify(data));\r\n            this.dispatchEvent(\"getUserInfo\", data);\r\n        });\r\n\r\n        //断线\r\n        th.ws.addHandler(\"disconnect\", data => {\r\n            cc.log(\"==>WebSocketManager 断开连接\");\r\n        });\r\n    },\r\n\r\n    connectServer: function({ ip, port }) {\r\n        cc.log(th.ws.connected);\r\n        th.ws.ip = ip;\r\n        th.ws.port = port;\r\n        th.ws.addr = `ws://${ip}:${port}/bull`;\r\n        th.ws.connect(\r\n            () => {\r\n                this.dispatchEvent(\"connect_success\");\r\n                cc.log(\"==>WebSocketManager 连接成功\");\r\n                //th.alert.show(\"提示\", \"连接成功\");\r\n                cc.director.loadScene(\"Hall\", () => {\r\n                    this.dispatchEvent(\"connect_success\");\r\n                });\r\n            },\r\n            () => {\r\n                cc.log(\"==>WebSocketManager 连接失败\");\r\n            }\r\n        );\r\n    }\r\n});\r\n"]}